<div class="markdown-editor-wrapper">
  <!-- Tab Navigation -->
  <div class="editor-tabs" *ngIf="showPreview">
    <button 
      type="button" 
      class="tab-button" 
      [class.active]="viewMode === 'preview'"
      (click)="switchToPreview()">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2"/>
      </svg>
      Preview
    </button>
    <button 
      type="button" 
      class="tab-button" 
      [class.active]="viewMode === 'edit'"
      (click)="switchToEdit()">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      Edit
      <span *ngIf="hasContentChanged" class="edit-indicator" title="Content has been modified">‚óè</span>
    </button>
  </div>

  <!-- Content Area -->
  <div class="editor-content">
    <!-- Preview Mode -->
    <div *ngIf="viewMode === 'preview'" 
         class="markdown-preview" 
         [style.min-height]="minHeight"
         [innerHTML]="renderedMarkdown">
    </div>
    
    <!-- Edit Mode -->
    <div *ngIf="viewMode === 'edit'" class="edit-container">
      <textarea 
        [(ngModel)]="content" 
        class="markdown-textarea"
        [placeholder]="placeholder"
        [style.min-height]="minHeight"
        (input)="onContentChange()"
        (blur)="onBlur()">
      </textarea>
      
      <div class="editor-footer">
        <div class="help-text">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
            <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M12 17h.01" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          You can edit the content directly. Markdown formatting is supported.
        </div>
        
        <div class="editor-info">
          <button 
            *ngIf="hasContentChanged && originalContent" 
            type="button" 
            class="reset-btn" 
            (click)="resetToOriginal()"
            title="Reset to original content">
            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M21 3v5h-5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M3 21v-5h5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            Reset
          </button>
          <span class="char-count">{{ characterCount }} characters</span>
          <span *ngIf="hasContentChanged" class="modified-badge">Modified</span>
        </div>
      </div>
    </div>
  </div>
</div>
