<!-- Sidebar -->
<aside class="sidebar" [class.collapsed]="collapsed" [class.show]="isMobileMenuOpen">
  <!-- Logo and App Name -->
  <div class="sidebar-header">
    <a [routerLink]="['/']" class="logo-link">
      <svg *ngIf="!imageLoaded" class="logo-image" width="32" height="32" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
        <rect width="32" height="32" rx="6" fill="var(--primary)"/>
        <text x="16" y="20" fill="white" text-anchor="middle" font-size="18" font-weight="bold">R</text>
      </svg>
      <img #logoImg [src]="logoSrc" [alt]="appName + ' Logo'" class="logo-image" 
          (error)="handleImageError($event)" 
          (load)="imageLoaded = true"
          [style.display]="imageLoaded ? 'block' : 'none'">
      <span class="app-name" *ngIf="!collapsed">{{ appName }}</span>
    </a>
    <button class="toggle-sidebar-btn" (click)="toggle()" aria-label="Toggle sidebar">
      <span class="chevron-icon" [class.rotate]="collapsed">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M15 6L9 12L15 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
        </svg>
      </span>
    </button>
  </div>

  <!-- Navigation Menu -->
  <nav class="sidebar-nav">
    <ul class="nav-list">
      <li *ngFor="let item of navItems" 
          class="nav-item" 
          [class.active]="isActive(item.route)">
        <a [routerLink]="item.route" class="nav-link" (click)="onNavItemClick(item)">
          <div class="nav-icon" [innerHTML]="safeNavIcons[item.label]"></div>
          <span *ngIf="!collapsed">{{ item.label }}</span>
        </a>
      </li>
    </ul>
  </nav>

  <!-- Sidebar Footer -->
  <div class="sidebar-footer">
    <button class="logout-btn" (click)="onLogout()">
      <div class="nav-icon">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M9 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V5C3 4.46957 3.21071 3.96086 3.58579 3.58579C3.96086 3.21071 4.46957 3 5 3H9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M16 17L21 12L16 7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M21 12H9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </div>
      <span *ngIf="!collapsed">Logout</span>
    </button>
  </div>
</aside>

<!-- Mobile menu toggle button (visible only on mobile) -->
<button 
  *ngIf="isBrowser && isMobile" 
  class="mobile-menu-toggle" 
  [class.active]="isMobileMenuOpen"
  (click)="toggleMobileMenu()" 
  aria-label="Toggle mobile menu">
  <span></span>
  <span></span>
  <span></span>
</button>

<!-- Mobile menu backdrop overlay -->
<div 
  *ngIf="isBrowser && isMobile && isMobileMenuOpen" 
  class="mobile-backdrop"
  (click)="closeMobileMenu()">
</div>