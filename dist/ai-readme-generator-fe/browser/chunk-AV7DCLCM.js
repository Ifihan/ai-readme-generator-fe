import{a as I}from"./chunk-7APNSPFN.js";import{a as T}from"./chunk-AOHPX5GM.js";import"./chunk-BUVZR4ON.js";import{A as x,B as g,C as f,Ha as P,Ia as O,J as h,M as r,P as b,Q as M,U as m,X as a,_ as k,ca as n,cb as E,da as i,ea as p,ha as C,ia as _,ja as c,pa as w,qa as s,ra as v,sa as S,z as u,za as y}from"./chunk-SUWS7CD2.js";function V(t,o){t&1&&(n(0,"div",10),g(),n(1,"svg",11),p(2,"path",12),i(),s(3," Loading user settings... "),i())}function G(t,o){if(t&1&&(n(0,"div",13),g(),n(1,"svg",14),p(2,"path",15)(3,"path",16),i(),s(4),i()),t&2){let e=c();r(4),S(" ",e.error," ")}}function H(t,o){if(t&1&&(n(0,"div",26),p(1,"img",27),i()),t&2){let e=c(2);r(),a("src",e.userSession.user_data.avatar_url,h)("alt",e.userSession.username)}}function A(t,o){if(t&1&&(n(0,"div",17)(1,"div",18),m(2,H,2,2,"div",19),n(3,"div",20)(4,"h3"),s(5),i(),n(6,"div",21)(7,"div",22)(8,"span",23),s(9,"Username:"),i(),n(10,"span",24),s(11),i()(),n(12,"div",22)(13,"span",23),s(14,"Public Repos:"),i(),n(15,"span",24),s(16),i()(),n(17,"div",22)(18,"span",23),s(19,"Installation:"),i(),n(20,"a",25),s(21," View installation settings on GitHub "),i()()()()()()),t&2){let e=c();r(2),a("ngIf",e.userSession.user_data==null?null:e.userSession.user_data.avatar_url),r(3),v((e.userSession.user_data==null?null:e.userSession.user_data.full_name)||e.userSession.username),r(6),v(e.userSession.username),r(5),v((e.userSession.user_data==null?null:e.userSession.user_data.public_repos)||0),r(4),a("href","https://github.com/settings/installations/"+e.userSession.installation_id,h)}}function z(t,o){t&1&&(n(0,"div",29),g(),n(1,"svg",30),p(2,"path",31)(3,"circle",32),i(),f(),n(4,"p"),s(5,"No user session found."),i()())}function j(t,o){if(t&1&&m(0,z,6,0,"div",28),t&2){let e=c();a("ngIf",!e.loading)}}function L(t,o){t&1&&(n(0,"span"),s(1,"Reinstall GitHub App"),i())}function B(t,o){t&1&&(n(0,"span"),s(1,"Processing..."),i())}function N(t,o){t&1&&(n(0,"span"),s(1,"Revoke GitHub App"),i())}function U(t,o){t&1&&(n(0,"span"),s(1,"Processing..."),i())}function Y(t,o){if(t&1){let e=C();n(0,"div",33)(1,"h3"),s(2,"GitHub App Settings"),i(),n(3,"p",34),s(4,"Manage your GitHub App installation and permissions"),i(),n(5,"div",35)(6,"button",36),_("click",function(){u(e);let d=c();return x(d.onReinstall())}),g(),n(7,"svg",37),p(8,"path",38)(9,"path",39)(10,"path",40),i(),m(11,L,2,0,"span",41)(12,B,2,0,"span",41),i(),f(),n(13,"button",42),_("click",function(){u(e);let d=c();return x(d.confirmRevoke())}),g(),n(14,"svg",37),p(15,"path",43),i(),m(16,N,2,0,"span",41)(17,U,2,0,"span",41),i(),f(),n(18,"button",44),_("click",function(){u(e);let d=c();return x(d.onLogout())}),g(),n(19,"svg",37),p(20,"path",45)(21,"path",46),i(),f(),n(22,"span"),s(23,"Logout"),i()()()()}if(t&2){let e=c();r(6),a("disabled",e.processing),r(5),a("ngIf",!e.processing),r(),a("ngIf",e.processing),r(),a("disabled",e.processing),r(3),a("ngIf",!e.processing),r(),a("ngIf",e.processing),r(),a("disabled",e.processing)}}function D(t,o){t&1&&(g(),n(0,"svg",14),p(1,"path",49)(2,"circle",50),i())}function F(t,o){t&1&&(g(),n(0,"svg",14),p(1,"path",15)(2,"path",16),i())}function J(t,o){if(t&1&&(n(0,"div",47)(1,"div"),m(2,D,3,0,"svg",48)(3,F,3,0,"svg",48),s(4),i()()),t&2){let e=c();r(),k(e.message.includes("Error")?"error":"success"),r(),a("ngIf",!e.message.includes("Error")),r(),a("ngIf",e.message.includes("Error")),r(),S(" ",e.message," ")}}function K(t,o){t&1&&p(0,"div",51)}function q(t,o){t&1&&(n(0,"span"),s(1,"Revoke"),i())}function Q(t,o){t&1&&(n(0,"span"),s(1,"Processing..."),i())}function W(t,o){if(t&1){let e=C();n(0,"div",52)(1,"div",53)(2,"h3",54),s(3,"Revoke GitHub App?"),i(),n(4,"p"),s(5,"This will disconnect the app from your GitHub account. You can reconnect later. Continue?"),i(),n(6,"div",55)(7,"button",56),_("click",function(){u(e);let d=c();return x(d.cancelRevoke())}),s(8,"Cancel"),i(),n(9,"button",57),_("click",function(){u(e);let d=c();return x(d.proceedRevoke())}),m(10,q,2,0,"span",41)(11,Q,2,0,"span",41),i()()()()}if(t&2){let e=c();r(9),a("disabled",e.processing),r(),a("ngIf",!e.processing),r(),a("ngIf",e.processing)}}var R=class t{constructor(o,e){this.authService=o;this.notificationService=e}userSession;message="";loading=!1;error="";processing=!1;showRevokeConfirm=!1;ngOnInit(){this.loading=!0;try{let o=localStorage.getItem("user_session");this.userSession=o?JSON.parse(o):null,this.userSession||(this.error="No user session found. Please log in again.")}catch{this.error="Error loading user session."}this.loading=!1}onReinstall(){this.processing=!0,this.message="",this.error="",this.authService.reinstallGitHubApp().subscribe({next:o=>{o?.install_url?(this.message=o.message||"Redirecting to GitHub App configuration...",setTimeout(()=>{window.location.href=o.install_url},1500)):this.message="GitHub App reinstall initiated successfully",this.processing=!1},error:o=>{this.error="Error initiating GitHub App reinstall",this.processing=!1}})}confirmRevoke(){this.showRevokeConfirm=!0,this.message="",this.error=""}cancelRevoke(){this.showRevokeConfirm=!1}proceedRevoke(){this.processing=!0,this.authService.revokeGitHubApp().subscribe({next:()=>{this.message="GitHub App revoked successfully",this.processing=!1,this.showRevokeConfirm=!1,this.authService.clearAuth(),localStorage.removeItem("user_session"),this.userSession=null},error:()=>{this.error="Error revoking GitHub App",this.processing=!1,this.showRevokeConfirm=!1}})}onLogout(){this.authService.clearAuth(),localStorage.removeItem("user_session")}static \u0275fac=function(e){return new(e||t)(b(I),b(E))};static \u0275cmp=M({type:t,selectors:[["app-settings"]],decls:13,vars:9,consts:[["noUser",""],[3,"showBackButton"],[1,"settings-wrapper"],["class","loading-message",4,"ngIf"],["class","error",4,"ngIf"],["class","user-details",4,"ngIf","ngIfElse"],["class","github-settings",4,"ngIf"],["class","message",4,"ngIf"],["class","modal-backdrop",4,"ngIf"],["class","modal","role","dialog","aria-modal","true","aria-labelledby","revoke-title",4,"ngIf"],[1,"loading-message"],["width","24","height","24","viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg",1,"animate-spin"],["d","M12 2V6M12 18V22M6 12H2M22 12H18M19.07 4.93L16.24 7.76M7.76 16.24L4.93 19.07M19.07 19.07L16.24 16.24M7.76 7.76L4.93 4.93","stroke","currentColor","stroke-width","2","stroke-linecap","round"],[1,"error"],["width","20","height","20","viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M12 8v5M12 16h.01","stroke","currentColor","stroke-width","2","stroke-linecap","round"],["d","M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z","stroke","currentColor","stroke-width","2"],[1,"user-details"],[1,"user-card"],["class","user-avatar",4,"ngIf"],[1,"user-info"],[1,"user-details-grid"],[1,"detail-item"],[1,"label"],[1,"value"],["target","_blank","rel","noopener",1,"value","link",3,"href"],[1,"user-avatar"],[3,"src","alt"],["class","no-user",4,"ngIf"],[1,"no-user"],["width","48","height","48","viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["cx","12","cy","7","r","4","stroke","currentColor","stroke-width","2"],[1,"github-settings"],[1,"settings-description"],[1,"actions"],["type","button",1,"btn-primary",3,"click","disabled"],["width","16","height","16","viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M1 4V10H7","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","M23 20V14H17","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","M20.49 9A9 9 0 0 0 5.64 5.64L1 10M23 14L18.36 18.36A9 9 0 0 1 3.51 15","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],[4,"ngIf"],["type","button",1,"btn-danger",3,"click","disabled"],["d","M18 6L6 18M6 6l12 12","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["type","button",1,"btn-secondary",3,"click","disabled"],["d","M16 17l5-5-5-5M21 12H9","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","M11 5V4a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4a2 2 0 0 0 2-2v-1","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],[1,"message"],["width","20","height","20","viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg",4,"ngIf"],["d","M9 12l2 2 4-4","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","2"],[1,"modal-backdrop"],["role","dialog","aria-modal","true","aria-labelledby","revoke-title",1,"modal"],[1,"modal-content"],["id","revoke-title"],[1,"modal-actions"],[1,"btn-secondary",3,"click"],[1,"btn-danger",3,"click","disabled"]],template:function(e,l){if(e&1&&(n(0,"app-page-layout",1)(1,"div",2)(2,"h2"),s(3,"User Settings"),i(),m(4,V,4,0,"div",3)(5,G,5,1,"div",4)(6,A,22,5,"div",5)(7,j,1,1,"ng-template",null,0,y)(9,Y,24,7,"div",6)(10,J,5,5,"div",7),i(),m(11,K,1,0,"div",8)(12,W,12,3,"div",9),i()),e&2){let d=w(8);a("showBackButton",!0),r(4),a("ngIf",l.loading),r(),a("ngIf",l.error),r(),a("ngIf",l.userSession&&!l.loading)("ngIfElse",d),r(3),a("ngIf",l.userSession&&!l.loading),r(),a("ngIf",l.message),r(),a("ngIf",l.showRevokeConfirm),r(),a("ngIf",l.showRevokeConfirm)}},dependencies:[O,P,T],styles:[".settings-wrapper[_ngcontent-%COMP%]{max-width:800px;margin:0 auto;padding:20px}.settings-wrapper[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:var(--text-primary);margin-bottom:30px;font-size:1.875rem;font-weight:600}.loading-message[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:12px;padding:40px;color:var(--text-secondary);font-size:1rem}.animate-spin[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.error[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:16px;background-color:#fee;border:1px solid #fcc;border-radius:8px;color:#d32f2f;margin-bottom:24px}.user-card[_ngcontent-%COMP%]{background:var(--bg-card);border:1px solid var(--border);border-radius:12px;padding:24px;margin-bottom:30px;display:flex;align-items:flex-start;gap:20px;transition:background-color .3s ease}.user-avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:80px;height:80px;border-radius:50%;border:2px solid var(--border);object-fit:cover}.user-info[_ngcontent-%COMP%]{flex:1}.user-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 20px;color:var(--text-primary);font-size:1.5rem;font-weight:600}.user-details-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:16px}.detail-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.detail-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{color:var(--text-tertiary);font-size:.875rem;font-weight:500}.detail-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:var(--text-primary);font-size:.95rem;font-weight:400}.no-user[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:16px;padding:60px 20px;color:var(--text-tertiary);text-align:center}.no-user[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{color:var(--text-tertiary)}.no-user[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:1.1rem}.github-settings[_ngcontent-%COMP%]{background:var(--bg-card);border:1px solid var(--border);border-radius:12px;padding:24px;margin-bottom:24px;transition:background-color .3s ease}.github-settings[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 8px;color:var(--text-primary);font-size:1.25rem;font-weight:600;text-align:center}.settings-description[_ngcontent-%COMP%]{margin:0 0 24px;color:var(--text-secondary);text-align:center;font-size:.95rem}.actions[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:16px;flex-wrap:wrap}.btn-primary[_ngcontent-%COMP%], .btn-danger[_ngcontent-%COMP%], .btn-secondary[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:8px;padding:12px 24px;border:none;border-radius:8px;font-size:.95rem;font-weight:500;cursor:pointer;transition:all .2s ease;text-decoration:none;min-width:180px;justify-content:center;box-shadow:0 2px 4px #0000001a}.btn-primary[_ngcontent-%COMP%]{background-color:var(--primary);color:#fff}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background-color:var(--primary-hover);transform:translateY(-1px);box-shadow:0 4px 8px #00000026}.btn-secondary[_ngcontent-%COMP%]{background-color:var(--bg-card);color:var(--text-primary);border:1px solid var(--border)}.btn-secondary[_ngcontent-%COMP%]:hover:not(:disabled){background-color:var(--bg-hover);transform:translateY(-1px);box-shadow:0 4px 8px #00000026}.btn-danger[_ngcontent-%COMP%]{background-color:#dc3545;color:#fff}.btn-danger[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#c82333;transform:translateY(-1px);box-shadow:0 4px 8px #dc35454d}.btn-primary[_ngcontent-%COMP%]:disabled, .btn-secondary[_ngcontent-%COMP%]:disabled, .btn-danger[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed;transform:none;box-shadow:0 2px 4px #0000001a}.message[_ngcontent-%COMP%]{margin-top:20px}.message[_ngcontent-%COMP%]   .success[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;color:#28a745;background:#d4edda;border:1px solid #c3e6cb;padding:12px 16px;border-radius:8px;font-size:.95rem}.message[_ngcontent-%COMP%]   .error[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;color:#dc3545;background:#f8d7da;border:1px solid #f5c6cb;padding:12px 16px;border-radius:8px;font-size:.95rem}@media (max-width: 768px){.settings-wrapper[_ngcontent-%COMP%]{padding:16px}.user-card[_ngcontent-%COMP%]{flex-direction:column;text-align:center}.user-details-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.actions[_ngcontent-%COMP%]{flex-direction:column;align-items:center}.btn-primary[_ngcontent-%COMP%], .btn-secondary[_ngcontent-%COMP%], .btn-danger[_ngcontent-%COMP%]{width:100%;max-width:250px}}.modal-backdrop[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000080;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);z-index:1000;animation:_ngcontent-%COMP%_fadeIn .2s ease-out}.modal[_ngcontent-%COMP%]{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;z-index:1001;padding:20px;animation:_ngcontent-%COMP%_fadeIn .2s ease-out}.modal-content[_ngcontent-%COMP%]{background:var(--bg-card);border:1px solid var(--border);border-radius:16px;padding:32px;max-width:480px;width:100%;box-shadow:0 20px 25px -5px #0000001a,0 10px 10px -5px #0000000a;animation:_ngcontent-%COMP%_slideIn .2s ease-out}.modal-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 16px;color:var(--text-primary);font-size:1.5rem;font-weight:600;text-align:center}.modal-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 24px;color:var(--text-secondary);font-size:1rem;line-height:1.5;text-align:center}.modal-actions[_ngcontent-%COMP%]{display:flex;gap:12px;justify-content:center;flex-wrap:wrap}.modal-actions[_ngcontent-%COMP%]   .btn-secondary[_ngcontent-%COMP%], .modal-actions[_ngcontent-%COMP%]   .btn-danger[_ngcontent-%COMP%]{min-width:120px;flex:1;max-width:160px}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_slideIn{0%{opacity:0;transform:translateY(-20px) scale(.95)}to{opacity:1;transform:translateY(0) scale(1)}}@media (max-width: 480px){.modal[_ngcontent-%COMP%]{padding:16px}.modal-content[_ngcontent-%COMP%]{padding:24px}.modal-actions[_ngcontent-%COMP%]{flex-direction:column}.modal-actions[_ngcontent-%COMP%]   .btn-secondary[_ngcontent-%COMP%], .modal-actions[_ngcontent-%COMP%]   .btn-danger[_ngcontent-%COMP%]{max-width:none}}"]})};export{R as SettingsComponent};
